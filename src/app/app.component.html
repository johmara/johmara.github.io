<div class="header-controls">
  <button class="search-trigger" (click)="openSearchModal()" aria-label="Search publications">
    <span class="shortcut-text">{{ vimModeService.isVimModeEnabled() ? '/' : 'ctrl k' }}</span>
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="11" cy="11" r="8"></circle>
      <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
  </button>
  <app-dark-mode-toggle></app-dark-mode-toggle>
  <app-vim-mode-toggle></app-vim-mode-toggle>
</div>

<app-search-modal *ngIf="isSearchModalOpen" (close)="closeSearchModal()"></app-search-modal>
<app-hint-overlay></app-hint-overlay>

<!-- Vim mode tooltip toggle button -->
<button
  class="vim-tooltip-toggle"
  *ngIf="vimModeService.isVimModeEnabled()"
  (click)="toggleVimTooltip()"
  [class.active]="isVimTooltipOpen"
  [attr.aria-label]="isVimTooltipOpen ? 'Hide vim shortcuts' : 'Show vim shortcuts'"
  type="button">
  <span class="vim-icon">V</span>
</button>

<!-- Vim mode tooltip -->
<div class="vim-tooltip" *ngIf="vimModeService.isVimModeEnabled() && isVimTooltipOpen">
  <div class="vim-tooltip-header">{{ vimModeService.isHintModeActive() ? 'Hint Mode' : 'Vim Navigation' }}</div>

  @if (vimModeService.isHintModeActive()) {
    <!-- Show only hint mode shortcuts when hint mode is active -->
    <div class="vim-tooltip-section">
      <div class="vim-tooltip-section-title">Jump to Hint</div>
      <div class="vim-tooltip-item"><kbd>gg</kbd> First on page</div>
      <div class="vim-tooltip-item"><kbd>G</kbd> Last on page</div>
      <div class="vim-tooltip-item"><kbd>H</kbd> Top of screen</div>
      <div class="vim-tooltip-item"><kbd>M</kbd> Middle of screen</div>
      <div class="vim-tooltip-item"><kbd>L</kbd> Bottom of screen</div>
    </div>
    <div class="vim-tooltip-section">
      <div class="vim-tooltip-section-title">Navigate</div>
      <div class="vim-tooltip-item"><kbd>n</kbd> Next hint</div>
      <div class="vim-tooltip-item"><kbd>N</kbd> Previous hint</div>
      <div class="vim-tooltip-item"><kbd>j</kbd> Scroll down</div>
      <div class="vim-tooltip-item"><kbd>k</kbd> Scroll up</div>
    </div>
    <div class="vim-tooltip-section">
      <div class="vim-tooltip-section-title">Actions</div>
      <div class="vim-tooltip-item"><kbd>Enter</kbd> Activate hint</div>
      <div class="vim-tooltip-item"><kbd>esc</kbd> Exit hint mode</div>
    </div>
  } @else {
    <!-- Show all vim shortcuts when hint mode is not active -->
    <div class="vim-tooltip-section">
      <div class="vim-tooltip-section-title">Scroll</div>
      <div class="vim-tooltip-item"><kbd>j</kbd> Down</div>
      <div class="vim-tooltip-item"><kbd>k</kbd> Up</div>
      <div class="vim-tooltip-item"><kbd>dd</kbd> Half page down</div>
      <div class="vim-tooltip-item"><kbd>uu</kbd> Half page up</div>
    </div>
    <div class="vim-tooltip-section">
      <div class="vim-tooltip-section-title">Jump</div>
      <div class="vim-tooltip-item"><kbd>gg</kbd> Top</div>
      <div class="vim-tooltip-item"><kbd>G</kbd> Bottom</div>
      <div class="vim-tooltip-item"><kbd>H</kbd> High</div>
      <div class="vim-tooltip-item"><kbd>M</kbd> Middle</div>
      <div class="vim-tooltip-item"><kbd>L</kbd> Low</div>
    </div>
    <div class="vim-tooltip-section">
      <div class="vim-tooltip-section-title">Actions</div>
      <div class="vim-tooltip-item"><kbd>f</kbd> Follow links</div>
      <div class="vim-tooltip-item"><kbd>/</kbd> Search</div>
    </div>
  }
</div>

<div class="mx-4">
  <router-outlet />
</div>

