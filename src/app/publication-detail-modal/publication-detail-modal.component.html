<div class="modal-overlay" (click)="onOverlayClick($event)">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="header-content">
        <h2>{{ publication.title }}</h2>
        <p class="authors">{{ publication.authors }}</p>
        <p class="published-in" *ngIf="publication.publishedIn">
          <i class="fa fa-book" aria-hidden="true"></i> {{ publication.publishedIn }} ({{ publication.date | date:'yyyy' }})
        </p>
      </div>
      <button class="close-btn" (click)="close()" aria-label="Close modal">Ã—</button>
    </div>

    <div class="modal-body">
      <div class="abstract-section" *ngIf="!showBibtex">
        <h3>Abstract</h3>
        <p class="abstract">{{ publication.description }}</p>
      </div>

      <div class="bibtex-section" *ngIf="showBibtex">
        <h3>BibTeX</h3>
        <pre class="bibtex-content">{{ bibtex }}</pre>
      </div>
    </div>

    <div class="modal-footer">
      <div class="action-buttons-left">
        <button *ngIf="publication.doi" class="action-btn" [class.active]="showBibtex" (click)="toggleBibtex()">
          {{ isLoadingBibtex ? 'Loading...' : (showBibtex ? 'Abstract' : 'BIB') }}
        </button>
        <button *ngIf="publication.doi" class="action-btn" (click)="copyCitation()">
          Copy Citation<span *ngIf="vimModeService.isVimModeEnabled()" class="vim-hint"> (yy)</span>
        </button>
        <button class="action-btn" (click)="openPDF()">
          PDF<span *ngIf="vimModeService.isVimModeEnabled()" class="vim-hint"> (p)</span>
        </button>
      </div>
      <button class="action-btn close-action" (click)="close()">
        Close<span *ngIf="vimModeService.isVimModeEnabled()" class="vim-hint"> (q)</span>
      </button>
    </div>
  </div>
</div>
